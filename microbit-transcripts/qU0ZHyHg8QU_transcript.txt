hey guys what's up it's yujin tang welcome to a live stream or a live code uh example it doesn't actually stream this is a video but welcome to a live coding example here we're going to build a web scraper um and i'm going to use this as an example i'm going to scrape this for the top uh universities and just like scrape the text from their page this is just an example i'm going to do a project on what the most commonly used phrases to describe the top colleges later and you'll see that so in order to do this you're going to have to pip install selenium and beautiful soup 4 and you'll also need to download chrome driver and i'll drop a link to that in the uh in the in the description so let's start by doing our imports as always import re import from from selenium import webdriver from selenium.webdriver.chrome.service [Music] import service this is the what we use to start the chrome driver from selenium.webdriver.chrome.options import options um what else do we need oh yeah we need beautiful soup from bs4 import beautiful soup and ah yes from time import sleep this is what we're going to use to make our program sleep to wait for the low times and then from random import rand and this is just to randomize our sleep time so we look less like a bot so we have a chrome driver path i already have this stored somewhere so once you download your chrome driver just store somewhere it doesn't have to be easy to remember just you know store it somewhere that you know where it is and then just uh you know insert it into your program uh let's see okay so chrome so let's see chrome service so service equals service chrome driver path yep okay uh options equals options um and then we'll just do options.headless equals true so this makes this so that the page doesn't actually pop up when you run this but um i'm going to need the page to pop up when we run it just for an example and then we'll add argument and we'll make it run incognito mode and then we'll just start a driver driver equals webdriver.chrome service equals service and then options equals options and we'll see if this works cool okay um so now what we're going to do is we're going to oops there we go we're going to go to the url driver.get url and then we're going to parse that so first we'll wait for it to load so sleep rand int somewhere between three and five seconds uh and then we'll just do soup equals beautiful soup uh driver.page source um oh yes html.parser and we'll just quit the driver here we're gonna have to we're gonna have to move this down later but we'll just quit it here for now okay so let's see what happens here great so we got selene to load i hate ads honestly there's just so many ads on this site okay uh and then somewhere between three to five seconds it should quit ah there we go cool um so let's take a look at the links in the soup so soup dot find uh so let's go with links soup.find all a and we'll just see what they look like see what all the links so this will print out all the links so the links that i care about are obviously you know these pages but we'll see what they look like haha i didn't print them oh okay well yeah i'm a professional python dev by the way i'm professional software dev so there we go that's a lot of links um well it's kind of useless to me why did i do that uh okay how about this let's print out four link in links print link href so this will print all the actual links in all of our links and since we're going to iterate through all of them it's going to print them on separate lines to be more parsable or more readable usually i like kind of remember to do that first but hey you know this is my first time doing a live coding session um for your for for online viewing so all right let's see what they look like what okay this is this is good enough though okay let's see um i don't care about any of these hmm well there are links on this page oh this looks kind of how do i even wow u.s news does a lot of rankings okay i don't see any of the ones that well let's i don't even know let's see what this link should look like um so here we're inspecting the link all right a class href best colleges princeton university 2627. best colleges that's just not even on here yeah okay so wow they have a ton of links on here so what we're going to do is we'll do find all href equals re.compile so i told you we're going to use regux so it should just be sla slash best colleges yeah slash dot star and that should that should get all of our links let's try again [Music] here we go okay princeton university columbia university harvard one two three four five six seven eight nine ten oh perfect okay so we will just we'll just grab these links so how am i gonna grab these links let's see um so let's make it start with best colleges and let's see how am i going to make it so that so let's let's actually wait let me just let me just check this so if i go to this site and then i add this what happens oh apparently it has that slash already in there for you 404 not found okay maybe it's just this and it is okay so then we'll have to make a base url of this base url equals this okay so that's what we're going to extend um [Music] so there's four of each right four of each okay and then we're going to make it so that it's not rankings how do you do regex that's not something well i don't know so let's let's just go look it up um regex oops regex to exclude certain terms the cat sat on the mat negative look ahead okay this lets you look ahead and discard matching if blacklisted character okay okay so let's what is uh i suppose it's the exclamation point all right so let's do oh uh and i think we'll have to do it rankings so rankings i think that should be fine uh we'll do uh i don't want photos either so we'll do uh photos and well yeah yeah and reviews i don't care about those either so let's see what this gives us so you can tell that i've never scraped this page for i have no idea how to how this page is set up or how any of this stuff is done i'm literally just like let's figure out how to do it oh there's none of them okay well maybe we just do this let's see if that works okay best colleges okay so we'll also have to get rid of my fit admissions rankings um dot star maybe drinking star maybe we can put the star there um or college star or compare star or admissions this is probably not the best way to do this but i don't i don't know a better way to do it so we're just stuck with this okay uh my fit and if this is the best way to do it then well hey i love that let's see how this tool works maybe i need to put the or sign like in but in the in the parentheses or i just like search for them and i just like drop them if they include it later so like oh haha sick that works exactly how oh no that does not work exactly how i thought it worked okay rankings that's that's not what i want to see maybe you have to put the dot star at the end here [Music] ah yes what what is this what is this whatever okay we're just gonna we're gonna get rid of the rankings and i'm just gonna drop these from the stuff manually okay uh so we'll say uh we'll make a set link uh okay top ten equals links if oh no top ten should equal an empty list my bad if link if college search and links or compare uh if yeah or compare in oh no it's not in links and link or compare and link or admissions in link or my fit and link yeah this is a not a very efficient thing but uh you know or photos in link or reviews in link continue uh uh i think else we can do top 10 dot append link and then we'll just do top 10 equals set top 10 and oh wait maybe let's just make it a set to begin with set and then we'll just add it and then it should just not be like that so print top ten and it's just give us the top 10 links okay cool yeah obviously i forgot to just extract the hrefs here so that's what happened that's why it's a big blob i also forgot to do four uh because i just you know i'm just one of those people that works fast and sometimes you gotta redo things because you work fast you know four link in top ten print link all right all right let's oh four what am i on today okay did oh we'll bleep that out here uh yeah okay yeah so i just did uh control d by the way and that is a shortcut in vs code to select the next same like word string i don't know how it works under the hood actually so ah here we go one two three four five six seven eight nine ten perfect all right so now we got our top ten uh now what we're gonna do is we're gonna go to each of these top tens and we're going to get the beautiful soup of that page and we're going to get the text so so actually what i'm going to do here is i'm going to go to the page itself and find out where we can no thanks i don't want to be in a survey uh oh gosh this is such a mess oh why did i pick this oh man come on well we can see what this looks like okay read more there we go we'll have to click three more we'll see let's see if i click read less okay so i'll probably just have to click the read more um that's a p what does this look like paragraph paragraph um it's also paragraph okay so what we're going to do is we're going to [Music] navigate to page click read more and then get text from all make soup make soup get text from all paragraphs all right driver.get link uh driver dot find element by dot css selector [Music] oh boy how do i import the buy one uh i think if i do it here oh i forgot where i did this selenium by dot css selector there we go uh import python what is this import called geez webdriver.comman.buy okay from selenium selenium.webdriver.com dot bye is this not right i imported by why is this oh really there's no selenium dot common that's what i'm talking about yeah okay i just maybe i spelled it wrong earlier i don't know all right there we go by css selector and let's see what this looks like again span text equals read more dot click uh oh i have to put the driver quit at the end because obviously we can't we can't use it whatever that doesn't exist right so uh and then we'll just do soup equals beautiful soup driver.page source again html.parser and then paragraphs equal soup dot find all p p and print paragraphs dot get text all right i think that's right well we'll we'll check all right so i'm putting exit at the end of the for loop so x is after the first one that way we just don't have to like oh i forgot to put a sleep time well all right let's try again what what what what is this wait a second what is this trash okay is it oh did it detect that i'm using a web scraper oh my god no way no way that would be crazy oh my god i think i'm actually well let's see if i let's see if i get rid of incognito what happens what's going on driver.geturl it just like just hung there do they know maybe they know wow this is kind of crazy like that's like that'd be kind of wild they just like wow i i'd be i mean i'm impressed like that means that they have something on here to like check for like selenium which is i mean selenium like is meant to it's like puppeteer it's meant to just imitate like a like a real person so that's kind of wild um go to http maybe that might work maybe if i just go to http you know oh okay okay maybe not maybe maybe it was just hanging earlier let's see what happens oh access to nine whoa okay okay let's try it one more time one more time if it really is just like you know just access denied you're just screwed like then i guess we're just screwed you know i mean at that point it's just like oh [ __ ] like that means that they have something that listens to selenium and then we'll have to find some other way to get around that see if this works this is quite interesting i've never uh this is i've never had selenium fail like this before oh what uh [Music] okay i'm gonna just stop this here this is definitely like something something's going on that's like [ __ ] that's messing this up okay so i'm gonna pop i'm gonna okay uh i went to get some water um i can't really think of a good way to do this so why don't we do this i'm going to all right all right here we go what i'm going to do is i'm going to quit the driver here and then we're going to we're going to try to just just start restart the driver at the end of every iteration um and if this doesn't work uh we'll just go to see if we can click the link i feel like us news is like thinks i'm i'm being sketchy right now like they probably know they're probably looking at my ip address and they're like what's this guy doing this is some sketchy some sketchy [ __ ] going on so hey okay let's get it oh oh let's get it oh boy yeah okay that's what i'm talking about all right this paragraph text is just gonna be a mess i bet come on come on let's go let's go i'll probably have to get an actions change so it moves down and clicks the link ah yeah okay what's where where did it where'd it break uh yeah yeah okay uh so i'm gonna oops uh that was the obs uh okay well let's import action chains uh from selenium.webdriver.actionchain action chain maybe it's action action actions really actions uh no not no one driver died maybe it's just same to actions maybe it's common there it is all right so [Music] uh okay yeah you have to click it oh yeah okay i don't have to click this i think i just scraped the p okay so what we'll do here is [Music] completely forget about this and completely forget about this and completely forget about this and see if this works yeah i hope that this is well we'll see what happens here in this getparagraphs.gettext module i told you [Music] oh interesting number two colombia got came up first this time i went to unc by the way unc is ranked 28th this year i think that's wrong they should rank it higher i wonder how much princeton paid to get ranked number one no but i'm kidding princeton's actually really good school well what i know i didn't even go there so it's still loading bro why is it still loading what's up with this all right well i don't know but we're gonna find out so oh oh my net nice [Music] uh yeah okay okay okay okay four p in paragraphs oh my god paragraphs print p dot get text all right so as you can see a lot of software development is sitting around and testing and waiting for things to go on well i guess it's just developing a webscaper a lot of times you're just typing but there's a lot of testing you gotta wait for things to compile you gotta wait for things to build so da da this time okay okay oh yeah okay awesome we got a text output let's take a look okay sick so we don't care about this um we don't care about this we don't care about this okay sick all right and we don't care about this stuff i don't care about any of this i don't care about any of this okay so this is good all right all right okay um let's see how are we going to get rid of this stuff um that's not even bro that's not even a paragraph what's this thing what oh okay okay here it is okay well i only want these paragraphs let's see class equals raw let's see what these these other classes look like why is so much just like okay it's nice statistics rankings let's look at this raw okay just like my name raw okay now let's take a look at what these have maybe they don't have like raw in their class name and if they do then we're screwed okay box okay okay okay let's try this okay find all div class equals re dot compile uh starts with raw uh wait what should i start with again oh actually i'm kind of curious what this says because like i don't want to include that nice okay i don't want to include that anyway cool what does it say this says raw content okay well maybe it's okay well let's take a look um div class is equal to raw yeah that's really all i care about uh let's just print p i want to see like the whole thing this time uh chromebook play the hottest games online and offline i'm tired ugh um chromebooks like i don't know like what chromebook has to do with gaming because like as far as i know like it's like the one thing you don't get if you're one if you want a game but serve smart guys see these ads are just so in your face like that's why python out goes i'm going to give a plug to my site here that's why python algos is never going to have ads so please support us by donating on the page all right let's see let's take a look um yeah this is mostly what i'm looking for yeah boy okay let's try this uh text equals oh wait no text equal well no actually this is right for p and paragraphs and text equals well yeah text equals dot join paragraphs no you know what no this is this is just too complicated okay so what we're going to do here is text equals [Music] space let's see what this looks like oh yeah yeah we should print the text um print text gosh i told you long ago on the round yeah that song's really stuck in my head if you watched one of my last videos i was seeing that like two days ago too it's just it's just in there i don't know like hey hey what's up with stanford this time all right all right let's see what they have to say about stamford bam bam bam bam bam advertisement for purdue on this on the page for stanford fun all right alcohol is permitted for students of legal age at stanford university show me the money yeah that's what i'm talking about all right this is it this is exactly what i wanted okay cool so basically what we're gonna do here to wrap this up is i'm gonna save all of this to a text file for each school and let's see okay so file name file name equals link dot okay so first let's let's link link.split we're going to split it on best colleges and i'm going to take the second one so file name equals that plus dot txt uh i'm going to just do this out here first for just check uh for a link in top ten print dot txt print file name exit it should hope it's actually here yeah okay what what is this talking about nice okay this really just takes so long to load why is it doing this to me i feel like they know that i'm like accessing this they're like like yo this is kind of sketchy like who's this guy just randomly coming to our website like all the time like what's his ip address you know like i don't know why it takes so long like it just doesn't make any sense like they got it oh i got a really sensitive pimple up here okay they got to know something like something's up like they're just like yo yo yo like all right all right that's fine so i'm gonna split on best colleges this and then we'll just do that okay let's order this and now we're gonna go back to we're gonna run in headless and we're gonna run an incognito hopefully that doesn't break it if it breaks it i'll just comment it back out so with open file name w as f um f dot write lines text is it right lines or right line lines iterable string okay maybe it's right line here's just right right string right rows yeah maybe it's just right where's the right lines honestly right nice it's got to be an interval it's just uh we'll just do it right whatever whatever and we'll figure it out you know if it breaks i let's do one and then i will see what it looks like and if it works we'll just do all of them so now it's running in headless so it's not even gonna pop up we're just gonna stare at the screen for like in the next like you know 20 30 seconds um usually during this time it's a good time to kind of just hold your breath and wait in anticipation i'm kidding i talked to the camera during this time for you you can probably just you know look at the screen maybe i should like speed this up when i upload this to youtube but i don't really know how to do that so that'll be have to come up to the next session i'm going to stretch oh i wish i had some jeopardy music to play maybe i do is that even loud i don't even know if you're allowed to play those like on these youtube videos so da [Music] yeah it's really stuck in my head this is taking like an insanely long time i honestly feel like us news is like on to me they like know they're like what's going on here like they're like there's some weird like traffic patterns here maybe uh i wish i would sleep longer or something yeah so when i run all 10 i'm just going to pause the video and come back when it's when it's done gotta stay hydrated i shouldn't have run it in headless mode now i don't even know what's going on now it's just like it's just like i was just now just sitting here in anticipation like just i'm gonna pause the video we're gonna figure out what happens when i get back okay we're back this thing got a timeout error so i'm just not gonna run it list headless and i'm not gonna run it incognito and i'm gonna hope that it works this time and if it doesn't um i think we'll have to take a break add some longer random wait times like i don't really don't know like why is there a way to like block ads with selenium maybe there is like hey okay so this worked this time so i think it was just like the headless mode maybe they can detect that you're running on headless mode and they're like yo this is totally automation software because it is automation software and and maybe like they'll just be like you can't do that maybe they're gonna ban me because they see this video on youtube they're gonna be like yo you're breaking out terms of services well luckily for me uh i don't use us news to read this stuff too often all right cool good enough this is this is a good enough uh text for me to to analyze later so let's do this for all of them um i'm gonna run this and i'm gonna pause the video until everything gets back and um actually yeah this is i mean this is pretty much the end of the video i can show you what all the text files look like at the end but uh this is pretty much it so if you've enjoyed this please you know give me a like give me a subscribe and uh peace out i'll see you guys next time okay cool um so as i promised i would show you all the files at the end when it was done it took a little bit to do but they are all here and for the next time this is going to be used in my analysis of the most common phrases used in articles to describe the top 10 universities in 2021 okay so uh like i said earlier you know thank you very much for watching um thank you if you like this video please give me a like give me a follow check out python algos where i post a bunch of tutorials on how to do cool projects like this alright peace out see you guys next time for real this time